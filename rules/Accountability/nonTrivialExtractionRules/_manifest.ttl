@prefix mf: <http://www.w3.org/2001/sw/DataAccess/tests/test-manifest#> .
@prefix kgi: <http://ns.inria.fr/kg/index#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

<> a mf:Manifest ;
    mf:entries (
        <simpleExtraction.ttl>
    ) .

<simpleExtraction.ttl> a mf:ManifestEntry ;
    kgi:onSuccess (
        [
            kgi:timeout "PT120S"^^xsd:duration ;
            kgi:recommendedPagination 500 ;
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?kg a dcat:Dataset .
                    ?kg a void:Dataset .
                    ?kg a dcmitype:Dataset .
                    ?kg a schema:Dataset .
                    ?kg a sd:Dataset .
                    ?kg a dataid:Dataset .
                    ?kg void:sparqlEndpoint $rawEndpointUrl .
                    ?kg ?p ?o .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                    ?kg ?p ?o .
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
        <provCreationDateExtraction.ttl>
        <provCreationLocationExtraction.ttl>
        <provCreationMethodExtraction.ttl>
        <provCreatorExtraction.ttl>
        <creatorPropertiesExtraction.ttl>
        <dcatDumpExtraction.ttl>
        <provEditorExtraction.ttl>
        <provModificationDateExtraction.ttl>
        <provModificationLocationExtraction.ttl>
        <provPublicationDateExtraction.ttl>
        <provPublisherExtraction.ttl>
        <dcatEndpointExtraction.ttl>
        <endpointPropertiesExtraction.ttl>
        <dcatWebpageExtraction.ttl>
        <dcatRequirements.ttl>
    ) ;
    kgi:onFailure (
        [
            mf:action """
                PREFIX prov: <http://www.w3.org/ns/prov#>
                PREFIX dqv: <http://www.w3.org/ns/dqv#>
                PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
                PREFIX void: <http://rdfs.org/ns/void#>
                PREFIX dcat: <http://www.w3.org/ns/dcat#>
                PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
                PREFIX earl: <http://www.w3.org/ns/earl#>
                PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
                PREFIX kgi: <http://ns.inria.fr/kg/index#>
                INSERT {
                        # Creation of the description
                        ?endpointDescription sd:endpoint $rawEndpointUrl ;
                            a sd:Service, dcat:DataService , prov:Entity , earl:TestSubject ;
                            dcat:endpointURL $rawEndpointUrl ;
                            rdfs:comment "No Dataset related with the IRI of the endpoint url was found." ;
                            prov:wasGeneratedBy <https://raw.githubusercontent.com/Jendersen/KG_accountability/main/nonTrivialExtractionRules/simpleExtraction.ttl#activity> ;
                            prov:generatedAtTime ?time .
                } WHERE {
                    BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str($rawEndpointUrl)), "Endpoint")) AS ?endpointDescription)
                    BIND(NOW() AS ?time)
                }
            """
        ]
    ) .

<provCreationDateExtraction.ttl> a mf:ManifestEntry ;
    kgi:onSuccess (
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?kg prov:wasGeneratedBy ?act .
                    # ?act a prov:Create .
                    ?act prov:startedAtTime ?date .
                    ?act a ?type .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                    ?kg prov:wasGeneratedBy ?act .
                    # ?act a prov:Create .
                    ?act prov:startedAtTime ?date .
                    OPTIONAL {
                        ?act a ?type .
                    }
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?kg prov:wasGeneratedBy ?act .
                    # ?act a prov:Create .
                    ?act prov:endedAtTime ?date .
                    ?act a ?type .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                    ?kg prov:wasGeneratedBy ?act .
                    # ?act a prov:Create .
                    ?act prov:endedAtTime ?date .
                    OPTIONAL {
                        ?act a ?type .
                    }
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
    ) .


<provCreationLocationExtraction.ttl> a mf:ManifestEntry ;
    kgi:onSuccess (
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?kg prov:wasGeneratedBy ?act .
                    # ?act a prov:Create .
                    ?act prov:atLocation ?location .
                    ?act a ?type .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                     ?kg prov:wasGeneratedBy ?act .
                     # ?act a prov:Create .
                     ?act prov:atLocation ?location .
                    OPTIONAL {
                        ?act a ?type .
                    }
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
    ) .


<provCreationMethodExtraction.ttl> a mf:ManifestEntry ;
    kgi:onSuccess (
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?kg prov:wasGeneratedBy ?act .
                    # ?act a prov:Create .
                    ?act prov:wasAssociatedWith ?agent .
                    ?agent a prov:SoftwareAgent .
                    ?act a ?type .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                   ?kg prov:wasGeneratedBy ?act .
                   # ?act a prov:Create .
                   ?act prov:wasAssociatedWith ?agent .
                   ?agent a prov:SoftwareAgent .
                    OPTIONAL {
                        ?act a ?type .
                    }
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
    ) .


<provCreatorExtraction.ttl> a mf:ManifestEntry ;
    kgi:onSuccess (
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?kg prov:wasGeneratedBy ?act .
                    # ?act a prov:Create .
                    ?act prov:wasAssociatedWith ?creator .
                    ?creator a ?type .
                    ?act a ?actType .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                   ?kg prov:wasGeneratedBy ?act .
                   # ?act a prov:Create .
                   ?act prov:wasAssociatedWith/prov:actedOnBehalfOf* ?creator .
                   ?creator a ?type .
                   VALUES ?type { foaf:Person schema:Person prov:Person foaf:Organization schema:Organization prov:Organization }
                    OPTIONAL {
                        ?act a ?actType .
                    }
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
    ) .

<creatorPropertiesExtraction.ttl> a mf:ManifestEntry ;
    kgi:onSuccess (
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?contributor a ?creatorType .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                    # Find a contributor
                    {
                        ?kg ?contribProp ?contributor .
                        VALUES ?contribProp { dcterms:creator dce:creator foaf:maker schema:creator pav:createdBy schema:author pav:authoredBy dcterms:contributor dce:contributor schema:contributor pav:contributedBy schema:editor pav:curatedBy schema:maintainer }
                    } UNION {
                        ?kg prov:wasGeneratedBy ?act .
                        # ?act a prov:Create .
                        ?act prov:wasAssociatedWith/prov:actedOnBehalfOf* ?contributor .
                        ?contributor a ?type .
                        VALUES ?type { foaf:Person schema:Person prov:Person foaf:Organization schema:Organization prov:Organization }
                    }

                    # Properties: type
                    ?contributor a ?creatorType .
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
            INSERT {
                GRAPH ?kgGraph {
                    ?contributor ?nameProp ?name .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                    # Find a contributor
                    {
                        ?kg ?contribProp ?contributor .
                        VALUES ?contribProp { dcterms:creator dce:creator foaf:maker schema:creator pav:createdBy schema:author pav:authoredBy dcterms:contributor dce:contributor schema:contributor pav:contributedBy schema:editor pav:curatedBy schema:maintainer }
                    } UNION {
                        ?kg prov:wasGeneratedBy ?act .
                        # ?act a prov:Create .
                        ?act prov:wasAssociatedWith/prov:actedOnBehalfOf* ?contributor .
                        ?contributor a ?type .
                        VALUES ?type { foaf:Person schema:Person prov:Person foaf:Organization schema:Organization prov:Organization }
                    }

                    # Properties: name
                    ?contributor ?nameProp ?name .
                    VALUES ?nameProp { rdfs:label schema:name foaf:name schema:legalName schema:givenName schema:familyName foaf:givenName foaf:familyName foaf:firstName foaf:lastName }
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?contributor ?contactProp ?contact .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                    # Find a contributor
                    {
                        ?kg ?contribProp ?contributor .
                        VALUES ?contribProp { dcterms:creator dce:creator foaf:maker schema:creator pav:createdBy schema:author pav:authoredBy dcterms:contributor dce:contributor schema:contributor pav:contributedBy schema:editor pav:curatedBy schema:maintainer }
                    } UNION {
                        ?kg prov:wasGeneratedBy ?act .
                        # ?act a prov:Create .
                        ?act prov:wasAssociatedWith/prov:actedOnBehalfOf* ?contributor .
                        ?contributor a ?type .
                        VALUES ?type { foaf:Person schema:Person prov:Person foaf:Organization schema:Organization prov:Organization }
                    }

                    # Properties: contact
                    ?contributor ?contactProp ?contact .
                    VALUES ?contactProp {foaf:mbox foaf:phone schema:contactPoint schema:email schema:telephone schema:address foaf:homepage}
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?contributor ?prop ?influence .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                    # Find a contributor
                    {
                        ?kg ?contribProp ?contributor .
                        VALUES ?contribProp { dcterms:creator dce:creator foaf:maker schema:creator pav:createdBy schema:author pav:authoredBy dcterms:contributor dce:contributor schema:contributor pav:contributedBy schema:editor pav:curatedBy schema:maintainer }
                    } UNION {
                        ?kg prov:wasGeneratedBy ?act .
                        # ?act a prov:Create .
                        ?act prov:wasAssociatedWith/prov:actedOnBehalfOf* ?contributor .
                        ?contributor a ?type .
                        VALUES ?type { foaf:Person schema:Person prov:Person foaf:Organization schema:Organization prov:Organization }
                    }

                    # Properties: inlfuences
                    ?contributor ?prop ?influence .
                    VALUES ?prop { schema:worksFor foaf:workplaceHomepage schema:sponsor schema:funder foaf:fundedBy schema:funding schema:nonprofitStatus schema:ownershipFundingInfo schema:parentOrganization schema:founder schema:ethicsPolicy schema:publishingPrinciples schema:correctionsPolicy schema:areaServed schema:memberOf schema:affiliation }
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?group foaf:member ?contributor .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                    # Find a contributor
                    {
                        ?kg ?contribProp ?contributor .
                        VALUES ?contribProp { dcterms:creator dce:creator foaf:maker schema:creator pav:createdBy schema:author pav:authoredBy dcterms:contributor dce:contributor schema:contributor pav:contributedBy schema:editor pav:curatedBy schema:maintainer }
                    } UNION {
                        ?kg prov:wasGeneratedBy ?act .
                        # ?act a prov:Create .
                        ?act prov:wasAssociatedWith/prov:actedOnBehalfOf* ?contributor .
                        ?contributor a ?type .
                        VALUES ?type { foaf:Person schema:Person prov:Person foaf:Organization schema:Organization prov:Organization }
                    }

                    # Properties: influences
                    ?group foaf:member ?contributor .
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?contributor ?prop ?qualifications .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                    # Find a contributor
                    {
                        ?kg ?contribProp ?contributor .
                        VALUES ?contribProp { dcterms:creator dce:creator foaf:maker schema:creator pav:createdBy schema:author pav:authoredBy dcterms:contributor dce:contributor schema:contributor pav:contributedBy schema:editor pav:curatedBy schema:maintainer }
                    } UNION {
                        ?kg prov:wasGeneratedBy ?act .
                        # ?act a prov:Create .
                        ?act prov:wasAssociatedWith/prov:actedOnBehalfOf* ?contributor .
                        ?contributor a ?type .
                        VALUES ?type { foaf:Person schema:Person prov:Person foaf:Organization schema:Organization prov:Organization }
                    }

                    # Properties: qualifications
                    ?contributor ?prop ?qualifications .
                    VALUES ?prop { foaf:workInfoHomepage schema:hasOccupation schema:jobTitle schema:award schema:knowsAbout foaf:publications foaf:schoolHomepage schema:alumniOf }
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)

            }
            """
        ]
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?contributor schema:hasCredential ?credential .
                    ?credential schema:competencyRequired ?skills .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                    # Find a contributor
                    {
                        ?kg ?contribProp ?contributor .
                        VALUES ?contribProp { dcterms:creator dce:creator foaf:maker schema:creator pav:createdBy schema:author pav:authoredBy dcterms:contributor dce:contributor schema:contributor pav:contributedBy schema:editor pav:curatedBy schema:maintainer }
                    } UNION {
                        ?kg prov:wasGeneratedBy ?act .
                        # ?act a prov:Create .
                        ?act prov:wasAssociatedWith/prov:actedOnBehalfOf* ?contributor .
                        ?contributor a ?type .
                        VALUES ?type { foaf:Person schema:Person prov:Person foaf:Organization schema:Organization prov:Organization }
                    }

                    # Properties: qualifications
                    ?contributor schema:hasCredential ?credential .
                    ?credential schema:competencyRequired ?skills .
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
    ) .

<dcatDumpExtraction.ttl> a mf:ManifestEntry ;
    kgi:onSuccess (
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                   ?kg dcat:distribution ?dist .
                   ?dist dcat:downloadURL ?url .
               }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                   ?kg dcat:distribution ?dist .
                   ?dist dcat:downloadURL ?url .
               }
               BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?kg schema:distribution ?dist .
                    ?dist schema:contentUrl ?url
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                    ?kg schema:distribution ?dist .
                    ?dist schema:contentUrl ?url .
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
    ) .

<provEditorExtraction.ttl> a mf:ManifestEntry ;
    kgi:onSuccess (
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?kg prov:wasGeneratedBy ?act .
                    # ?act a prov:Contribute .
                    ?act prov:wasAssociatedWith ?contributor .
                    ?contributor a ?type .
                    ?act a ?actType .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                     ?kg prov:wasGeneratedBy ?act .
                     # ?act a prov:Contribute .
                     ?act prov:wasAssociatedWith/prov:actedOnBehalfOf* ?contributor .
                     ?contributor a ?type .
                     VALUES ?type { foaf:Person schema:Person prov:Person foaf:Organization schema:Organization prov:Organization }
                    OPTIONAL {
                        ?act a ?actType .
                    }
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
    ) .

<provModificationDateExtraction.ttl> a mf:ManifestEntry ;
    kgi:onSuccess (
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?kg prov:wasGeneratedBy ?act .
                    # {?act a prov:Contribute . } UNION {?act a prov:Modify . } UNION {?act a prov:Replace . }
                    ?act prov:startedAtTime ?date .
                    ?act a ?actType .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                    ?kg prov:wasGeneratedBy ?act .
                    # {?act a prov:Contribute . } UNION {?act a prov:Modify . } UNION {?act a prov:Replace . }
                    ?act prov:startedAtTime ?date .
                    OPTIONAL {
                        ?act a ?actType .
                    }
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?kg prov:wasGeneratedBy ?act .
                    # {?act a prov:Contribute . } UNION {?act a prov:Modify . } UNION {?act a prov:Replace . }
                    ?act prov:endedAtTime ?date .
                    ?act a ?actType .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                     ?kg prov:wasGeneratedBy ?act .
                     # {?act a prov:Contribute . } UNION {?act a prov:Modify . } UNION {?act a prov:Replace . }
                     ?act prov:endedAtTime ?date .
                    OPTIONAL {
                        ?act a ?actType .
                    }
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
    ) .

<provCreationLocationExtraction.ttl> a mf:ManifestEntry ;
    kgi:onSuccess (
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?kg prov:wasGeneratedBy ?act .
                    # {?act a prov:Contribute . } UNION {?act a prov:Modify . } UNION {?act a prov:Replace . }
                    ?act prov:atLocation ?location .
                    ?act a ?type .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                    ?kg prov:wasGeneratedBy ?act .
                    # {?act a prov:Contribute . } UNION {?act a prov:Modify . } UNION {?act a prov:Replace . }
                    ?act prov:atLocation ?location .
                    OPTIONAL {
                        ?act a ?type .
                    }
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
    ) .

<provPublicationDateExtraction.ttl> a mf:ManifestEntry ;
    kgi:onSuccess (
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?kg prov:wasGeneratedBy ?act .
                    ?act a prov:Publish .
                    ?act prov:startedAtTime ?date .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                    ?kg prov:wasGeneratedBy ?act .
                    ?act a prov:Publish .
                    ?act prov:startedAtTime ?date .
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?kg prov:wasGeneratedBy ?act .
                    ?act a prov:Publish .
                    ?act prov:endedAtTime ?date .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                     ?kg prov:wasGeneratedBy ?act .
                     ?act a prov:Publish .
                     ?act prov:endedAtTime ?date .
                 }
                 BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
    ) .

<provPublisherExtraction.ttl> a mf:ManifestEntry ;
    kgi:onSuccess (
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?kg prov:wasGeneratedBy ?act .
                    ?act a prov:Publish .
                    ?act prov:wasAssociatedWith ?publisher .
                    ?publisher a ?type .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                    ?kg prov:wasGeneratedBy ?act .
                    ?act a prov:Publish .
                    ?act prov:wasAssociatedWith/prov:actedOnBehalfOf* ?publisher .
                    ?publisher a ?type .
                    VALUES ?type { foaf:Person schema:Person prov:Person foaf:Organization schema:Organization prov:Organization }
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
    ) .

<dcatEndpointExtraction.ttl> a mf:ManifestEntry ;
    kgi:onSuccess (
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?kg dcat:accessService ?service .
                    ?service dcat:endpointURL ?endpoint .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                     # Find a SPARQL endpoint
                     ?kg dcat:accessService ?service .
                     ?service dcat:endpointURL ?endpoint .
                 }
                 BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?kg dcat:accessService ?service .
                    ?service sd:endpoint ?endpoint .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                     # Find a SPARQL endpoint
                     ?kg dcat:accessService ?service .
                     ?service sd:endpoint ?endpoint .
                 }
                 BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?service dcat:servesDataset ?kg .
                    ?service dcat:endpointURL ?endpoint .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                     # Find a SPARQL endpoint
                     ?service dcat:servesDataset ?kg .
                     ?service dcat:endpointURL ?endpoint .
                 }
                 BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?service dcat:servesDataset ?kg .
                    ?service sd:endpoint ?endpoint .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                     # Find a SPARQL endpoint
                     ?service dcat:servesDataset ?kg .
                     ?service sd:endpoint ?endpoint .
                 }
                 BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
    ) .

<endpointPropertiesExtraction.ttl> a mf:ManifestEntry ;
    kgi:onSuccess (
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?endpoint sd:supportedLanguage ?language .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                        ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                        ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                        ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                        ?service sd:endpoint $rawEndpointUrl . }

                    # Find a SPARQL endpoint
                    { ?kg schema:contentUrl ?endpoint }
                    UNION { ?kg void:sparqlEndpoint ?endpoint . }
                    UNION {?kg dcat:accessService ?service .
                            ?service dcat:endpointURL ?endpoint .  }
                    UNION {?kg dcat:accessService ?service .
                            ?service sd:endpoint ?endpoint . }
                    UNION {?service dcat:servesDataset ?kg .
                            ?service dcat:endpointURL ?endpoint . }
                    UNION {?service dcat:servesDataset ?kg .
                            ?service sd:endpoint ?endpoint . }

                    ?endpoint sd:supportedLanguage ?language .
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?endpoint sd:resultFormat ?format .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                        ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                        ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                        ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                        ?service sd:endpoint $rawEndpointUrl . }

                    # Find a SPARQL endpoint
                    { ?kg schema:contentUrl ?endpoint }
                    UNION { ?kg void:sparqlEndpoint ?endpoint . }
                    UNION {?kg dcat:accessService ?service .
                            ?service dcat:endpointURL ?endpoint .  }
                    UNION {?kg dcat:accessService ?service .
                            ?service sd:endpoint ?endpoint . }
                    UNION {?service dcat:servesDataset ?kg .
                            ?service dcat:endpointURL ?endpoint . }
                    UNION {?service dcat:servesDataset ?kg .
                            ?service sd:endpoint ?endpoint . }

                    ?endpoint sd:resultFormat ?format .
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
    ) .

<dcatWebpageExtraction.ttl> a mf:ManifestEntry ;
    kgi:onSuccess (
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?kg dcat:distribution ?dist .
                    ?dist dcat:accessURL ?url .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                           ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                           ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                           ?service sd:endpoint $rawEndpointUrl . }

                    ?kg dcat:distribution ?dist .
                    ?dist dcat:accessURL ?url .
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
    ) .

<dcatRequirements.ttl> a mf:ManifestEntry ;
    kgi:onSuccess (
        [
            mf:action """
            PREFIX void: <http://rdfs.org/ns/void#>
            PREFIX dcat: <http://www.w3.org/ns/dcat#>
            PREFIX dcmitype: <http://purl.org/dc/dcmitype/>
            PREFIX schema: <http://schema.org/>
            PREFIX sd: <http://www.w3.org/ns/sparql-service-description#>
            PREFIX prov: <http://www.w3.org/ns/prov#>
            PREFIX pav: <http://purl.org/pav/>
            PREFIX foaf: <http://xmlns.com/foaf/0.1/>
            PREFIX dce: <http://purl.org/dc/elements/1.1/>
            PREFIX dcterms: <http://purl.org/dc/terms/>
            PREFIX dataid: <http://dataid.dbpedia.org/ns/core#>
            INSERT {
                GRAPH ?kgGraph {
                    ?kg dcat:distribution ?dist .
                    ?dist dataid:softwareRequirement ?requirements .
                }
            } WHERE {
                SERVICE $rawEndpointUrl {
                    # Find the KG : is a Dataset
                    { ?kg a dcat:Dataset }
                    UNION { ?kg a void:Dataset }
                    UNION { ?kg a dcmitype:Dataset }
                    UNION { ?kg a schema:Dataset }
                    UNION { ?kg a sd:Dataset }
                    UNION { ?kg a dataid:Dataset }

                    # is linked directly or not to the endpoint
                    { ?kg ?endpointLink $rawEndpointUrl . }
                    UNION {?kg dcat:accessService ?service .
                            ?service dcat:endpointURL $rawEndpointUrl .  }
                    UNION {?kg dcat:accessService ?service .
                            ?service sd:endpoint $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                            ?service dcat:endpointURL $rawEndpointUrl . }
                    UNION {?service dcat:servesDataset ?kg .
                            ?service sd:endpoint $rawEndpointUrl . }

                    ?kg dcat:distribution ?dist .
                    ?dist dataid:softwareRequirement ?requirements .
                }
                BIND(Iri(CONCAT("http://ns.inria.fr/kg/index#", MD5(str(?kg)), "Graph")) AS ?kgGraph)
            }
            """
        ]
    ) .
